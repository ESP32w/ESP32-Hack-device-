# Отчет по проекту: Web Exploit Utilities для ESP32

## Введение

Данный документ представляет собой отчет о разработке набора утилит для проведения этичного пентестинга веб-приложений с использованием платформы ESP32. Проект включает в себя реализацию пяти основных утилит: XSS тестер, Form Brute (брутфорс форм), LFI/RFI сканер, Admin Panel Finder и SQL-инъекция мини-сканер. Особое внимание было уделено добавлению механизмов для повышения анонимности и безопасности при использовании данных утилит, таких как настройка User-Agent, Referer и задержек между запросами.

## Архитектура и Дизайн

Проект структурирован модульно, где каждая утилита представляет собой отдельный класс C++ (`.h` и `.cpp` файлы). Это обеспечивает гибкость, масштабируемость и простоту поддержки кода. Был создан общий конфигурационный файл `web_exploit_config.h` для управления глобальными настройками безопасности и анонимности, которые применяются ко всем утилитам.

### Компоненты системы:

1.  **Основное приложение ESP32 (подразумевается):** Управляет пользовательским интерфейсом (веб-интерфейс, предоставленный пользователем `index.html` и `style.css`), обрабатывает команды пользователя и вызывает соответствующие утилиты.
2.  **Модули утилит:**
    *   `XSSTester`: Автоматизирует проверку на наличие уязвимостей Cross-Site Scripting (XSS) путем отправки типичных XSS-векторов в параметры URL и поля форм.
    *   `FormBrute`: Осуществляет перебор логинов и паролей для форм аутентификации, используя как встроенные короткие словари, так и словари с SD-карты (если поддерживается и реализована соответствующая логика чтения с SD).
    *   `LFIRFIScanner`: Проверяет уязвимости Local File Inclusion (LFI) и Remote File Inclusion (RFI) путем подстановки специальных путей и URL в параметры запросов.
    *   `AdminPanelFinder`: Осуществляет поиск административных панелей веб-сайта путем перебора списка популярных путей.
    *   `SQLInjectionScanner`: Выполняет базовые тесты на наличие SQL-инъекций путем отправки характерных SQL-команд в параметры запросов.
3.  **Конфигурация безопасности (`web_exploit_config.h`):**
    *   `currentUserAgent`: Позволяет задавать кастомный User-Agent для HTTP-запросов.
    *   `currentReferer`: Позволяет задавать кастомный Referer.
    *   `requestDelayMs`: Устанавливает задержку между HTTP-запросами.
    *   `useRandomDelay`, `minRandomDelayMs`: Позволяют использовать случайные задержки в заданном диапазоне.
    *   Предусмотрена структура для настроек прокси, однако их полная реализация на ESP32 с использованием стандартной библиотеки `HTTPClient` может быть ограничена и требует дополнительных библиотек или более низкоуровневой работы с сетью.

### Пользовательский интерфейс:

Предоставленные файлы `index.html` и `style.css` формируют основу веб-интерфейса. Логика взаимодействия с этим интерфейсом (обработка нажатий кнопок, получение данных из полей ввода, отображение результатов) должна быть реализована в основном скетче ESP32, который будет использовать созданные классы утилит. Файлы `utilities.cpp` и `utilities.h`, а также файлы атак (`ack_flood_attack`, `probe_flood_attack`, `beacon_spam_attack`, `deauth_attack`) относятся к другому набору функциональности (сетевые атаки Wi-Fi), который не был напрямую затронут в рамках разработки веб-эксплойт утилит, но может быть интегрирован в общий проект на ESP32.

## Реализованные утилиты и их возможности

Каждая утилита была реализована с учетом возможности настройки через `WebExploitSettings`.

### 1. XSS Тестер (`xss_tester.h`, `xss_tester.cpp`)
*   **Назначение:** Автоматическая проверка веб-страниц и форм на уязвимости типа Cross-Site Scripting.
*   **Функционал:**
    *   Принимает URL цели, имя параметра для тестирования и список XSS-пейлоадов.
    *   Отправляет GET и POST запросы с пейлоадами.
    *   Анализирует ответ сервера на предмет отражения пейлоада без должного экранирования.
    *   Использует предопределенный список стандартных XSS-векторов, который может быть расширен.
*   **Механизмы безопасности:** Использует настройки User-Agent, Referer и задержек из `WebExploitSettings`.

### 2. Form Brute (`form_brute.h`, `form_brute.cpp`)
*   **Назначение:** Перебор учетных данных для форм входа.
*   **Функционал:**
    *   Принимает URL страницы входа, имена параметров для логина и пароля, а также идентификатор успешного входа (строка в ответе или ее отсутствие).
    *   Поддерживает использование встроенных списков логинов/паролей и загрузку словарей с SD-карты (требуется инициализация SD и корректный путь к файлу).
    *   Предоставляет callback-функцию для отслеживания прогресса.
*   **Механизмы безопасности:** Использует настройки User-Agent, Referer и задержек.

### 3. LFI/RFI Сканер (`lfi_rfi_scanner.h`, `lfi_rfi_scanner.cpp`)
*   **Назначение:** Поиск уязвимостей Local File Inclusion и Remote File Inclusion.
*   **Функционал:**
    *   Принимает URL цели, имя тестируемого параметра и списки LFI/RFI пейлоадов.
    *   Отправляет запросы с пейлоадами, пытаясь включить локальные или удаленные файлы.
    *   Анализирует ответ на наличие характерных признаков успешной эксплуатации (например, содержимое системных файлов для LFI).
    *   Использует предопределенные списки пейлоадов и индикаторов успеха.
*   **Механизмы безопасности:** Использует настройки User-Agent, Referer и задержек.

### 4. Admin Panel Finder (`admin_panel_finder.h`, `admin_panel_finder.cpp`)
*   **Назначение:** Обнаружение скрытых административных панелей.
*   **Функционал:**
    *   Принимает базовый URL сайта.
    *   Перебирает список популярных путей к административным панелям (например, `/admin/`, `/administrator/`, `/cpanel/`).
    *   Анализирует HTTP-коды ответов (200 OK, 401 Unauthorized, 403 Forbidden) для идентификации существующих панелей.
*   **Механизмы безопасности:** Использует настройки User-Agent, Referer и задержек.

### 5. SQL-инъекция мини-сканер (`sql_injection_scanner.h`, `sql_injection_scanner.cpp`)
*   **Назначение:** Базовое тестирование на уязвимости к SQL-инъекциям.
*   **Функционал:**
    *   Принимает URL цели, имя тестируемого параметра и список SQL-пейлоадов.
    *   Отправляет GET и POST запросы с пейлоадами.
    *   Анализирует ответ сервера на наличие характерных ошибок SQL, указывающих на возможную уязвимость.
    *   Использует предопределенный список базовых SQL-пейлоадов и индикаторов ошибок.
*   **Механизмы безопасности:** Использует настройки User-Agent, Referer и задержек.

## Инструкции по использованию и интеграции

1.  **Подключение библиотек:** Убедитесь, что в вашем основном `.ino` файле проекта ESP32 подключены все необходимые заголовочные файлы утилит (`xss_tester.h`, `form_brute.h` и т.д.) и `web_exploit_config.h`.
2.  **Инициализация:**
    *   Создайте экземпляр структуры `WebExploitSettings` и настройте желаемые параметры безопасности (User-Agent, Referer, задержки).
    *   Создайте экземпляры классов необходимых утилит.
    ```cpp
    #include "web_exploit_config.h"
    #include "xss_tester.h"
    // ... другие утилиты

    WebExploitSettings currentSettings;
    XSSTester xssScanner;
    // ... другие сканеры

    void setup() {
        Serial.begin(115200);
        // currentSettings.currentUserAgent = "MyCustomAgent/1.0";
        // currentSettings.requestDelayMs = 500;
        // ... другие настройки
    }
    ```
3.  **Вызов утилит:** В логике вашего приложения (например, в обработчиках команд из веб-интерфейса) вызывайте методы `beginTest()` соответствующих утилит, передавая им необходимые параметры и объект `currentSettings`.
    ```cpp
    // Пример вызова XSS тестера
    // String targetUrl = "http://example.com/search.php";
    // String targetParam = "query";
    // std::vector<String> xss_payloads; // Можно оставить пустым для использования дефолтных
    // String xssResults = xssScanner.beginTest(targetUrl, targetParam, xss_payloads, currentSettings);
    // Serial.println(xssResults);
    // Отправьте xssResults в веб-интерфейс
    ```
4.  **Обработка результатов:** Результаты работы утилит возвращаются в виде строки (`String`), которую можно отобразить в веб-интерфейсе или передать по Serial порту.
5.  **Интеграция с веб-интерфейсом:** Модифицируйте ваш основной скетч ESP32 для обработки HTTP-запросов от `index.html`. Используйте библиотеки, такие как `ESPAsyncWebServer`, для создания веб-сервера. JavaScript на стороне клиента (`index.html`) должен отправлять AJAX-запросы на ESP32 с параметрами для тестов и отображать полученные результаты.

## Рекомендации по безопасности и этичному использованию

*   **Этический взлом:** Данные утилиты предназначены исключительно для использования в целях этичного хакинга и тестирования на проникновение **только на тех системах, на тестирование которых у вас есть явное разрешение владельца**. Несанкционированное использование этих инструментов против чужих систем является незаконным.
*   **Анонимность:** Хотя предусмотрены настройки User-Agent и Referer, а также задержки, полной анонимности на ESP32 достичь сложно. IP-адрес устройства ESP32 будет виден целевому серверу. Для повышения анонимности следует рассматривать использование внешних прокси-серверов или VPN, что выходит за рамки текущей реализации на уровне `HTTPClient`.
*   **Ограничения ESP32:** ESP32 имеет ограниченные ресурсы (память, вычислительная мощность) по сравнению с полноценными компьютерами. Это может накладывать ограничения на:
    *   Размер словарей для брутфорса.
    *   Сложность и количество одновременно отправляемых запросов.
    *   Скорость выполнения тестов.
    *   Возможности парсинга сложных HTML/JavaScript структур на стороне ESP32.
*   **Обнаружение:** Агрессивное сканирование с большим количеством запросов за короткое время может быть обнаружено системами защиты (WAF, IDS/IPS) и привести к блокировке IP-адреса вашего ESP32.
*   **Обновление пейлоадов:** Списки пейлоадов (XSS, SQLi, LFI/RFI пути) следует регулярно обновлять, так как появляются новые векторы атак и методы защиты.
*   **Очистка данных:** В текущей реализации не предусмотрены специфические функции для "очистки чувствительных данных" после использования, кроме как перезагрузка ESP32. Если утилиты будут хранить какие-либо временные данные (например, найденные учетные данные), следует предусмотреть механизм их безопасного удаления или не сохранять их вовсе после отображения пользователю.

## Заключение

Разработанный набор утилит предоставляет базовый функционал для проведения тестирования на проникновение веб-приложений с использованием ESP32. Модульная архитектура и настраиваемые параметры безопасности делают его гибким инструментом для специалистов по безопасности и энтузиастов. Дальнейшее развитие может включать улучшение механизмов парсинга, добавление поддержки более сложных сценариев атак, расширение списков пейлоадов и более глубокую интеграцию с механизмами анонимизации.

## Прилагаемые файлы

Все исходные коды (`.h` и `.cpp` файлы для каждой утилиты, `web_exploit_config.h`), а также предоставленные пользователем файлы (`index.html`, `style.css`, `utilities.cpp`, `utilities.h`, `ack_flood_attack.cpp`, `ack_flood_attack.h`, `probe_flood_attack.cpp`, `probe_flood_attack.h`, `beacon_spam_attack.cpp`, `beacon_spam_attack.h`, `deauth_attack.cpp`, `deauth_attack.h`, `data_structures.h`) будут упакованы в zip-архив.

